<!doctype html>
<html>
   <head>
      <title>Images in HTML Canvas</title>
   </head>
   <body>
      <canvas id="canvas"></canvas>
      <br>
      <button id="greyscale">greyscale</button>
      <script>
         window.onload = function() {
            const img = new Image();
            img.src = "mikhail-nilov.jpg";
            img.onload = function() {
               ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            }

            const canvas = document.getElementById("canvas");
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext("2d");

            const greyScale = function() {
               let pixels = ctx.getImageData(0, 0, canvas.width, canvas.height);
               let pixeldata = pixels.data;
               for (let i = 0; i < pixeldata.length; i += 4) {
                  const avg = (pixeldata[i] + pixeldata[i + 1] + pixeldata[i + 2]) / 3;
                  pixeldata[i] = avg;
                  pixeldata[i + 1] = avg;
                  pixeldata[i + 2] = avg;
               }
               ctx.putImageData(pixels, 0, 0);
            }

            const btnGreyScale = document.getElementById("greyscale");
            btnGreyScale.addEventListener("click", greyScale);
         };
      </script>
   </body>
</html>

